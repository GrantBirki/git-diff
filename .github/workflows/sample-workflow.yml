name: sample-workflow

on:
  pull_request:

permissions:
  contents: read

jobs:
  sample:
    runs-on: ubuntu-latest
    steps:
      # Need to checkout for testing the Action in this repo
      - uses: actions/checkout@2541b1294d2704b0964813337f33b291d3f8596b # pin@v3.0.2
        with:
          fetch-depth: 0 # needed to checkout all branches

      # Start check the PR diff
      - uses: ./
        id: git-diff

      # Print the diff in JSON format
      - name: echo json diff
        run: echo "${{ steps.git-diff.outputs.json-diff }}"

      # Save the raw diff to a file
      - name: echo raw diff
        run: echo "${{ steps.git-diff.outputs.raw-diff }}" > raw-diff.txt

      # Upload the raw diff as an artifact
      - uses: actions/upload-artifact@v3
        with:
          name: raw-diff
          path: raw-diff.txt
